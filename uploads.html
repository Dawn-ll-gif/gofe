<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå°ç®¡ç†ç³»ç»Ÿ - åå¤å¤§å­¦</title>
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="admin-container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="admin-sidebar">
            <div class="sidebar-header">
                <h2>åå°ç®¡ç†</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li class="active">
					<li><a href="dashboard.html" nclick="showSection('dashboard')">
                        <span class="icon">ğŸ“Š</span> ä»ªè¡¨ç›˜
                    </a></li>
                    <li><a href="users.html"  onClick="showsection('users')">
                        <span class="icon">ğŸ‘¥</span> ç”¨æˆ·ç®¡ç†
                    </a></li>
                    <li><a href= "news.html" onclick="showSection('news')">
                        <span class="icon">ğŸ“°</span> æ–°é—»ç®¡ç†
                    </a></li>
                    <li><a href="students.html" onclick="showSection('students')">
                        <span class="icon">ğŸ“</span> å­¦ç”Ÿç®¡ç†
                    </a></li>
                    <li><a href="teachers.html" onclick="showSection('teachers')">
                        <span class="icon">ğŸ‘¨â€ğŸ«</span> æ•™å¸ˆç®¡ç†
                    </a></li>
                    <li><a href="courses.html" onclick="showSection('courses')">
                        <span class="icon">ğŸ“š</span> è¯¾ç¨‹ç®¡ç†
                    </a></li>
                    <li><a href="uploads.html" onclick="showSection('uploads')">
                        <span class="icon">ğŸ“¤</span> ä¸Šä¼ ç®¡ç†
                    </a></li>
                    <li><a href="settings.html" onclick="showSection('settings')">
                        <span class="icon">âš™ï¸</span> ç³»ç»Ÿè®¾ç½®
                    </a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" class="logout-btn">é€€å‡ºç™»å½•</a>
            </div>
        </aside>
           <!-- ä¸»å†…å®¹åŒº -->
    <main class="admin-main">
        <!-- å¤´éƒ¨ -->
        <header class="admin-header">
            <div class="header-left">
                <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
                <h1>ä¸Šä¼ ç®¡ç†</h1>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span>ç®¡ç†å‘˜</span>
                    <img src="https://picsum.photos/40/40?person" alt="ç”¨æˆ·å¤´åƒ">
                </div>
            </div>
        </header>

        <!-- å†…å®¹åŒºåŸŸ -->
        <section class="admin-section active" id="uploads">
            <div class="section-header">
                <h2>æ–‡ä»¶åˆ—è¡¨</h2>
                <div class="section-actions">
                    <input type="text" class="search-input" placeholder="æœç´¢æ–‡ä»¶..." oninput="searchFiles()">
                    <select class="filter-select" onchange="filterFiles()">
                        <option value="">æ‰€æœ‰ç±»å‹</option>
                        <option value="å›¾ç‰‡">å›¾ç‰‡</option>
                        <option value="æ–‡æ¡£">æ–‡æ¡£</option>
                        <option value="è§†é¢‘">è§†é¢‘</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                    <button class="btn btn-primary" onclick="openUploadModal()">ä¸Šä¼ æ–‡ä»¶</button>
                </div>
            </div>

            <!-- æ–‡ä»¶è¡¨æ ¼ -->
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>æ–‡ä»¶å</th>
                            <th>ç±»å‹</th>
                            <th>å¤§å°</th>
                            <th>ä¸Šä¼ æ—¶é—´</th>
                            <th>ä¸Šä¼ è€…</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="fileTableBody">
                        <!-- æ–‡ä»¶æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- åˆ†é¡µ -->
            <div class="pagination">
                <div class="pagination-info">æ˜¾ç¤º 1-10 æ¡ï¼Œå…± 50 æ¡</div>
                <div class="pagination-buttons">
                    <button class="btn btn-secondary">ä¸Šä¸€é¡µ</button>
                    <button class="btn active">1</button>
                    <button class="btn">2</button>
                    <button class="btn">3</button>
                    <span class="pagination-ellipsis">...</span>
                    <button class="btn">5</button>
                    <button class="btn btn-secondary">ä¸‹ä¸€é¡µ</button>
                </div>
            </div>
        </section>
    </main>
</div>

<!-- ä¸Šä¼ æ–‡ä»¶æ¨¡æ€æ¡† -->
<div class="modal" id="uploadModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>ä¸Šä¼ æ–‡ä»¶</h3>
            <button class="close-btn" onclick="closeUploadModal()">Ã—</button>
        </div>
        <div class="modal-body">
            <form class="modal-form" id="uploadForm">
                <div class="form-group">
                    <label>é€‰æ‹©æ–‡ä»¶ <span class="required">*</span></label>
                    <input type="file" id="fileInput" required>
                </div>
                <div class="form-group">
                    <label>æ–‡ä»¶ç±»å‹</label>
                    <select id="fileType">
                        <option value="å›¾ç‰‡">å›¾ç‰‡</option>
                        <option value="æ–‡æ¡£">æ–‡æ¡£</option>
                        <option value="è§†é¢‘">è§†é¢‘</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>æ–‡ä»¶æè¿°</label>
                    <textarea id="fileDescription" rows="3" placeholder="è¯·è¾“å…¥æ–‡ä»¶æè¿°..."></textarea>
                </div>
                <div class="form-group">
                    <label>è®¿é—®æƒé™</label>
                    <select id="fileAccess">
                        <option value="å…¬å¼€">å…¬å¼€</option>
                        <option value="ç§æœ‰">ç§æœ‰</option>
                        <option value="ä»…ç®¡ç†å‘˜">ä»…ç®¡ç†å‘˜</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeUploadModal()">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">ä¸Šä¼ </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // æ–‡ä»¶æ•°æ®
    let fileData = [
        {id: 1, name: "æ ¡å›­é£æ™¯.jpg", type: "å›¾ç‰‡", size: "2.5 MB", time: "2023-04-15 10:30", uploader: "ç®¡ç†å‘˜", status: "å·²ä¸Šä¼ "},
        {id: 2, name: "æ•™å­¦å¤§çº².pdf", type: "æ–‡æ¡£", size: "1.2 MB", time: "2023-04-14 14:20", uploader: "å¼ æ•™æˆ", status: "å·²å®¡æ ¸"},
        {id: 3, name: "å¼€å­¦å…¸ç¤¼.mp4", type: "è§†é¢‘", size: "150 MB", time: "2023-04-13 09:15", uploader: "æè€å¸ˆ", status: "ä¸Šä¼ ä¸­"}
    ];

    // æ¸²æŸ“æ–‡ä»¶åˆ—è¡¨
    function renderFileList(files = fileData) {
        const tbody = document.getElementById('fileTableBody');
        tbody.innerHTML = '';
        files.forEach(file => {
            const row = `
                <tr>
                    <td>${file.name}</td>
                    <td>${file.type}</td>
                    <td>${file.size}</td>
                    <td>${file.time}</td>
                    <td>${file.uploader}</td>
                    <td><span class="status ${file.status === 'å·²ä¸Šä¼ ' ? 'active' : file.status === 'å·²å®¡æ ¸' ? 'approved' : 'pending'}">${file.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-view" onclick="viewFile(${file.id})">æŸ¥çœ‹</button>
                        <button class="btn btn-sm btn-edit" onclick="editFile(${file.id})">ç¼–è¾‘</button>
                        <button class="btn btn-sm btn-delete" onclick="deleteFile(${file.id})">åˆ é™¤</button>
                    </td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    }

    // æœç´¢æ–‡ä»¶
    function searchFiles() {
        const searchTerm = document.querySelector('.search-input').value.toLowerCase();
        const filtered = fileData.filter(file => 
            file.name.toLowerCase().includes(searchTerm) || 
            file.uploader.toLowerCase().includes(searchTerm)
        );
        renderFileList(filtered);
    }

    // ç­›é€‰æ–‡ä»¶
    function filterFiles() {
        const typeFilter = document.querySelector('.filter-select').value;
        if (!typeFilter) {
            renderFileList();
            return;
        }
        const filtered = fileData.filter(file => file.type === typeFilter);
        renderFileList(filtered);
    }

    // æ‰“å¼€ä¸Šä¼ æ¨¡æ€æ¡†
    function openUploadModal() {
        document.getElementById('uploadModal').classList.add('active');
    }

    // å…³é—­ä¸Šä¼ æ¨¡æ€æ¡†
    function closeUploadModal() {
        document.getElementById('uploadModal').classList.remove('active');
        document.getElementById('uploadForm').reset();
    }

    // æäº¤ä¸Šä¼ è¡¨å•
    document.getElementById('uploadForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const fileInput = document.getElementById('fileInput');
        const fileType = document.getElementById('fileType').value;
        const fileDescription = document.getElementById('fileDescription').value;
        const fileAccess = document.getElementById('fileAccess').value;
        
        if (fileInput.files.length === 0) {
            showMessage('è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼', 'error');
            return;
        }
        
        const file = fileInput.files[0];
        const newFile = {
            id: fileData.length + 1,
            name: file.name,
            type: fileType,
            size: formatFileSize(file.size),
            time: new Date().toLocaleString('zh-CN'),
            uploader: "ç®¡ç†å‘˜",
            status: "å·²ä¸Šä¼ "
        };
        
        fileData.push(newFile);
        renderFileList();
        closeUploadModal();
        showMessage('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼', 'success');
    });

    // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…
    function viewFile(id) {
        const file = fileData.find(f => f.id === id);
        if (file) {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>æ–‡ä»¶è¯¦æƒ…</h3>
                        <button class="close-btn" onclick="this.parentElement.parentElement.remove()">Ã—</button>
                    </div>
                    <div class="modal-body">
                        <div class="detail-view">
                            <div class="file-preview">
                                <div class="file-preview-icon">
                                    ${getFileIcon(file.type)}
                                </div>
                                <div class="file-info">
                                    <div class="file-name">${file.name}</div>
                                    <div class="file-details">
                                        ç±»å‹ï¼š${file.type} | å¤§å°ï¼š${file.size} | ä¸Šä¼ æ—¶é—´ï¼š${file.time}
                                    </div>
                                </div>
                                <div class="file-actions">
                                    <button class="btn btn-primary">ä¸‹è½½</button>
                                    <button class="btn btn-secondary">åˆ†äº«</button>
                                </div>
                            </div>
                            <div class="detail-section">
                                <h4>æ–‡ä»¶ä¿¡æ¯</h4>
                                <div class="detail-items">
                                    <div class="detail-item">
                                        <span class="detail-label">æ–‡ä»¶åï¼š</span>
                                        <span class="detail-value">${file.name}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">æ–‡ä»¶ç±»å‹ï¼š</span>
                                        <span class="detail-value">${file.type}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">æ–‡ä»¶å¤§å°ï¼š</span>
                                        <span class="detail-value">${file.size}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">ä¸Šä¼ æ—¶é—´ï¼š</span>
                                        <span class="detail-value">${file.time}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">ä¸Šä¼ è€…ï¼š</span>
                                        <span class="detail-value">${file.uploader}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-label">çŠ¶æ€ï¼š</span>
                                        <span class="detail-value"><span class="status ${file.status === 'å·²ä¸Šä¼ ' ? 'active' : file.status === 'å·²å®¡æ ¸' ? 'approved' : 'pending'}">${file.status}</span></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
    }

    // è·å–æ–‡ä»¶å›¾æ ‡
    function getFileIcon(type) {
        const icons = {
            'å›¾ç‰‡': 'ğŸ–¼ï¸',
            'æ–‡æ¡£': 'ğŸ“„',
            'è§†é¢‘': 'ğŸ¬',
            'å…¶ä»–': 'ğŸ“'
        };
        return icons[type] || 'ğŸ“';
    }

    // ç¼–è¾‘æ–‡ä»¶
    function editFile(id) {
        const file = fileData.find(f => f.id === id);
        if (file) {
            document.getElementById('fileType').value = file.type;
            document.getElementById('fileDescription').value = "æ–‡ä»¶æè¿°...";
            document.getElementById('fileAccess').value = "å…¬å¼€";
            openUploadModal();
        }
    }

    // åˆ é™¤æ–‡ä»¶
    function deleteFile(id) {
        if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥æ–‡ä»¶å—ï¼Ÿ')) {
            fileData = fileData.filter(f => f.id !== id);
            renderFileList();
            showMessage('æ–‡ä»¶åˆ é™¤æˆåŠŸï¼', 'success');
        }
    }

    // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
    function showMessage(text, type) {
        const message = document.createElement('div');
        message.className = `message message-${type}`;
        message.innerHTML = `
            <div class="message-icon">${type === 'success' ? 'âœ“' : '!'}</div>
            <div class="message-text">${text}</div>
            <button class="message-close" onclick="this.parentElement.remove()">Ã—</button>
        `;
        document.body.appendChild(message);
        setTimeout(() => message.remove(), 3000);
    }

    // åˆ‡æ¢ä¾§è¾¹æ ï¼ˆç§»åŠ¨ç«¯ï¼‰
    function toggleSidebar() {
        document.querySelector('.admin-sidebar').classList.toggle('active');
    }

    // é¡µé¢åŠ è½½æ—¶æ¸²æŸ“æ–‡ä»¶åˆ—è¡¨
    document.addEventListener('DOMContentLoaded', renderFileList);
</script>
